<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Carrinho de Compras - Utilizando</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Carrinho de Compras</h1>
    
    <div id="produtos">
        <strong>Produtos no carrinho:</strong>
        <div id="lista"></div> 
    </div>

    <div id="contador"><strong>Quantidade de itens:</strong> 0</div>

    <div id="total"><strong>Valor total:</strong> R$ 0.00</div>

    <button onclick="adicionarItem()">Adicionar Produto Aleatório</button>

    <script>
            //VERSAO QUE UTILIZA O PADRAO OBSERVER
            
        //class que representa o carrinho de compras
        class Carrinho {
            constructor() {
                this.itens = [];        // lista dos itens no carrinho
                this.observers = [];   // lista dos observadores que serao notificados
            }

            //add observer
            subscribe(observer) {
                this.observers.push(observer);
            }

            //remove observer
            unsubscribe(observer) {
                this.observers = this.observers.filter(obs => obs !== observer);
            }

            //add um novo item e notifica os observer
            adicionarItem(item) {
                this.itens.push(item);
                this.notificar();
            }

            //notifica os observer com a nova lista de itens
            notificar() {
                this.observers.forEach(observer => observer.update(this.itens));
            }
        }

        //OBSERVER: contador
        //atualiza a quantidade de itens no carrinho
        class Contador {
            constructor(elemento) {
                this.elemento = elemento;
            }

            update(itens) {
                this.elemento.textContent = `Quantidade de itens: ${itens.length}`;
            }
        }

        //OBSERVER: Totalizador
        //atualiza o valor total
        class Totalizador {
            constructor(elemento) {
                this.elemento = elemento;
            }

            update(itens) {
                const total = itens.reduce((acc, item) => acc + item.preco, 0);
                this.elemento.textContent = `Valor total: R$ ${total.toFixed(2)}`;
            }
        }

        //OBSERVER: ListaProdutos
        //atualiza a lista visual dos produtos
        class ListaProdutos {
            constructor(elemento) {
                this.elemento = elemento;
            }

            update(itens) {
                //limpa a lista 
                this.elemento.innerHTML = '';

                //add os itens na lista
                itens.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'item';
                    div.textContent = `${item.nome} - R$ ${item.preco.toFixed(2)}`;
                    this.elemento.appendChild(div);
                });
            }
        }

        //instancias dos observadores
        //instancia do carrinho
        const carrinho = new Carrinho();

        const contador = new Contador(document.getElementById('contador'));
        const totalizador = new Totalizador(document.getElementById('total'));
        const lista = new ListaProdutos(document.getElementById('lista'));

        //add os observadores no carrinho
        carrinho.subscribe(contador);
        carrinho.subscribe(totalizador);
        carrinho.subscribe(lista);

        //produtos 
        const produtos = [
            { nome: 'Camiseta', preco: 50 },
            { nome: 'Tênis', preco: 200 },
            { nome: 'Boné', preco: 30 },
            { nome: 'Calça', preco: 120 },
            { nome: 'Jaqueta', preco: 300 },
            { nome: 'Luvas', preco: 300 },
            { nome: 'Relógio', preco: 150 },
            { nome: 'Óculos', preco: 80 },
            { nome: 'Cinto', preco: 40 },
            { nome: 'Bolsa', preco: 90 },
            { nome: 'Mochila', preco: 110 }
        ];

        //funcao que add um produto no carrinho
        function adicionarItem() {
            const item = produtos[Math.floor(Math.random() * produtos.length)];
            carrinho.adicionarItem(item);
        }
    </script>
</body>
</html>
